<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Details - CRESSIDA</title> <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header class="navbar">
        <div class="container">
            <a href="index.html" class="navbar-brand">CRESSIDA</a>
            <nav class="navbar-nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="markets.html" class="nav-link">Markets</a>
                <a href="leaderboard.html" class="nav-link">Leaderboard</a>
                <a href="about.html" class="nav-link">About</a>
                <a href="terms.html" class="nav-link">Terms</a>
                </nav>
            <div class="navbar-actions">
                <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle theme">
                    <i class="fas fa-sun"></i>
                </button>
                <a href="login.html" id="user-action-btn" class="btn btn-primary">Login</a>
            </div>
        </div>
    </header>

    <main class="container page-content" id="market-detail-content">
        <header class="page-header">
            <h1 id="market-question-title">Loading market...</h1>
            <p>
                <span id="market-category-badge" class="category-badge">---</span>
                <span class="market-meta-item">Ends: <span id="market-end-date">--/--/----</span></span>
            </p>
        </header>

        <div class="market-detail-grid">
            <div class="market-detail-main">
                <section class="market-chart-section card">
                    <h2>Price History</h2>
                    <div class="chart-container" style="position: relative; height:280px; width:100%;"> <canvas id="priceHistoryChart"></canvas>
                    </div>
                </section>

                <section class="market-info-section card">
                    <h2>Market Information</h2>
                    <div id="market-info-details">
                        <p><strong>Description:</strong> <span id="market-info-description">Loading...</span></p>
                        <p><strong>Resolution Criteria:</strong> <span id="market-info-resolution">Loading...</span></p>
                        <p><strong>Total Volume Traded:</strong> ZAR <span id="market-info-volume">--</span></p>
                    </div>
                </section>
            </div>

            <aside class="market-detail-sidebar">
                <section class="market-trade-section card">
                    <h2>Trade</h2>
                    <div class="current-prices-detail">
                        <p>YES: <strong id="current-yes-price" class="price-yes">--ZAR</strong></p>
                        <p>NO: <strong id="current-no-price" class="price-no">--ZAR</strong></p>
                    </div>
                    <form id="trade-form" class="mt-1">
                        <div class="form-group">
                            <label>Your Prediction:</label>
                            <div class="outcome-selector">
                                <button type="button" class="btn btn-sm btn-yes-outline" data-outcome="YES">Buy YES</button>
                                <button type="button" class="btn btn-sm btn-no-outline" data-outcome="NO">Buy NO</button>
                            </div>
                            <input type="hidden" id="selected-outcome" name="outcome">
                            <input type="hidden" id="selected-price" name="price">
                        </div>
                        <div class="form-group">
                            <label for="trade-stake">Your Stake (ZAR):</label>
                            <input type="number" id="trade-stake" name="stake" class="form-input" placeholder="e.g., 10" min="1" step="any">
                        </div>
                        <div class="trade-summary">
                            <p>Shares to receive: <span id="shares-to-receive">--</span></p>
                            <p>Avg. Price per Share: <span id="avg-price-per-share">--ZAR</span></p>
                            <p>Potential Payout: <span id="potential-payout">ZAR --.--</span></p>
                            <p class="small-text">(If your prediction is correct, each share pays out R100)</p>
                        </div>
                        <button type="submit" id="confirm-trade-btn" class="btn btn-primary btn-block mt-1">Place Trade</button>
                        <p id="trade-message" class="form-message" style="display:none;"></p>
                    </form>
                    <p id="login-to-trade-message" style="display:none;" class="text-center mt-1 small-text">
                        Please <a href="login.html" class="link-accent">login</a> or <a href="register.html" class="link-accent">register</a> to trade.
                    </p>
                </section>

                <section class="market-order-book-section card"> <h2>Order Book</h2>
                    <div class="order-book-tabs">
                        <button class="btn btn-sm btn-outline active" data-tab="bids">Bids (Buy YES)</button>
                        <button class="btn btn-sm btn-outline" data-tab="asks">Asks (Sell YES)</button>
                    </div>
                    <div id="bids-order-book" class="order-book-content active-tab-content">
                        <table class="styled-table order-book-table">
                            <thead><tr><th>Price (ZAR)</th><th>Quantity</th><th>Total (ZAR)</th></tr></thead>
                            <tbody id="bids-table-body"><tr><td colspan="3" class="text-center">Loading...</td></tr></tbody>
                        </table>
                    </div>
                    <div id="asks-order-book" class="order-book-content" style="display:none;">
                        <table class="styled-table order-book-table">
                            <thead><tr><th>Price (ZAR)</th><th>Quantity</th><th>Total (ZAR)</th></tr></thead>
                            <tbody id="asks-table-body"><tr><td colspan="3" class="text-center">Loading...</td></tr></tbody>
                        </table>
                    </div>
                </section>
            </aside>
        </div> </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; <span id="current-year"></span> Intellectual Property of Justin Mukwevho.
                <a href="https://Justin-Mukwevho.github.io/CRESSIDA/" target="_blank" rel="noopener noreferrer" class="link-accent" style="margin-left: 5px;">
                <i class="fab fa-github"></i> View on GitHub
            </a>
            </p>
            <nav class="footer-nav">
                <a href="about.html" aria-label="About CRESSIDA">About</a>
                <a href="terms.html" aria-label="Terms of service">Terms</a>
                <a href="privacy.html" aria-label="Privacy policy">Privacy</a>
            </nav>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script src="js/data.js"></script>
    <script src="js/auth.js"></script> <script src="js/market-detail.js"></script>
</body>
</html>